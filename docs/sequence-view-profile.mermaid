sequenceDiagram
    participant User as User (Browser)
    participant UI as Dashboard UI
    participant AuthCtrl as AuthController
    participant AuthSvc as AuthService
    participant Token as TokenProvider
    participant UserRepo as UserRepository
    participant EmpCtrl as EmployeeController
    participant EmpSvc as EmployeeService
    participant EmpRepo as EmployeeRepository
    participant TSCtrl as TimesheetController
    participant TSSvc as TimesheetService
    participant TSRepo as TimesheetRepository
    participant DB as Database
    
    User->>UI: Navigate to Dashboard
    
    UI->>UI: Get token from localStorage
    
    alt No Token
        UI-->>User: Redirect to Login
    else Token Exists
        UI->>AuthCtrl: GET /api/profile {Authorization: token}
        
        AuthCtrl->>AuthSvc: validateToken(token)
        AuthSvc->>Token: validateToken(token)
        Token-->>AuthSvc: boolean result
        
        alt Token Invalid
            AuthSvc-->>AuthCtrl: Unauthorized
            AuthCtrl-->>UI: 401 Unauthorized
            UI->>UI: Clear localStorage
            UI-->>User: Redirect to Login
        else Token Valid
            AuthSvc->>Token: getUserIdFromToken(token)
            Token-->>AuthSvc: userId
            
            AuthSvc->>UserRepo: findById(userId)
            UserRepo->>DB: SELECT * FROM users WHERE user_id = ?
            DB-->>UserRepo: User data
            UserRepo-->>AuthSvc: User object
            
            AuthSvc-->>AuthCtrl: User profile
            AuthCtrl-->>UI: 200 OK {user}
            
            UI->>UI: Display user info
            
            par Load Employees
                UI->>EmpCtrl: GET /api/employees {Authorization: token}
                EmpCtrl->>EmpSvc: getEmployeeList(userId)
                EmpSvc->>EmpRepo: findByUserId(userId)
                EmpRepo->>DB: SELECT * FROM employees WHERE created_by_user_id = ?
                DB-->>EmpRepo: Employee list
                EmpRepo-->>EmpSvc: Employee[]
                EmpSvc-->>EmpCtrl: Employee[]
                EmpCtrl-->>UI: 200 OK {employees}
                UI->>UI: Populate employee dropdown
            and Load Timesheet Records
                UI->>TSCtrl: GET /api/timesheet/records {Authorization: token}
                TSCtrl->>TSSvc: getTimesheetRecords(userId)
                TSSvc->>TSRepo: findByUserId(userId)
                TSRepo->>DB: SELECT * FROM timesheet_records WHERE created_by_user_id = ?
                DB-->>TSRepo: Record list
                TSRepo-->>TSSvc: TimesheetRecord[]
                TSSvc-->>TSCtrl: TimesheetRecord[]
                TSCtrl-->>UI: 200 OK {records}
                UI->>UI: Display timesheet table
            and Load Summary
                UI->>TSCtrl: GET /api/timesheet/summary {Authorization: token}
                TSCtrl->>TSSvc: calculateSummary(userId)
                TSSvc->>TSRepo: findByUserId(userId)
                TSRepo->>DB: SELECT employee_id, SUM(hours_worked) FROM timesheet_records GROUP BY employee_id
                DB-->>TSRepo: Summary data
                TSRepo-->>TSSvc: Summary object
                TSSvc-->>TSCtrl: Summary
                TSCtrl-->>UI: 200 OK {summary}
                UI->>UI: Display employee summary
            end
            
            UI-->>User: Show complete dashboard
        end
    end
